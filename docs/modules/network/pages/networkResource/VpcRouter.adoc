= VPC路由器

== 简介
创建VPC的步骤：

* 上传VPC镜像
* 建立路由器规格

image::vpc/vrOffering.png[]
* 创建VPC路由器

image::vpc/createVpc.png[]


== 路由器规格

路由器规格指定VPC的公用参数：比如镜像文件，管理网络，公有网络，以及CPU，内存的规格。

CPU，内存的规格在创建VPC以后可以修改,生产环境建议大于4C8G.

管理网络必须是可以和ZStack管理节点互通的网络，否则创建VPC会失败。

== VPC路由器信息

image::vpc/vpc router.png[]

VPC是一个特殊类型的云主机，创建VPC以后，公有网络就是VPC的默认网络。

VPC可以添加多个公有网络，而且可以修改默认公网。

路由器规格中的管理网络，公有网络和VPC的默认公网是不能从VPC移除的

== VPC路由器的链接状态

管理节点定时发送心跳包到VPC路由器，如果心跳发送失败，VPC路由器就会自动重连，进入”_连接中_“状态，

如果重连成功，进入”_已连接_“状态，否则进入“_失联_”状态。

== VPC高可用组

VPC路由器作为网络业务的一个核心节点，为了避免单点故障，VPC高可用组创建两台完全相同配置的两台VPC，通过KeepAlived, 选举其中一台为Master路由器。
如果Master故障，Backup路由器能迅速切换到为Master路由器，快速恢复网络流量。

image::vpc/vpcha.png[]

[NOTE]
VPC高可用组其他的应用场景。比如，当前VPC镜像版本太旧，可以先删除Backup路由器，使用新的镜像重新创建Backup路由器，在业务允许的时候，进行主备切换，然后使用相同的步骤升级另外一个路由器的镜像。

